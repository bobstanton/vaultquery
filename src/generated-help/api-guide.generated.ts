// Generated by md-to-obsidian-dom
// Source: api-guide.md
/* eslint-disable obsidianmd/ui/sentence-case, obsidianmd/no-obsidian-branding -- Generated help content */

import './styles.generated.css';

import type { RenderContext } from './types.generated';

export const pageId = "api-guide";
export const pageTitle = "VaultQuery API Guide";

export const meta = {
  id: "api-guide",
  title: "VaultQuery API Guide",
};

export const dynamicKeys: string[] = [];
export const linkedPages: string[] = [];

/**
 * Render the "VaultQuery API Guide" help page
 * @param container - Container element to render into
 * @param ctx - Render context with code highlighting and dynamic content handlers
 */
export function render(container: HTMLElement, ctx: RenderContext): void {
  container.createEl('h1', { cls: 'vaultquery-help-heading vaultquery-help-h1', text: "VaultQuery API Guide" });
  const para = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para.appendText("This guide explains how to use VaultQuery from a third-party Obsidian plugin.");
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "Getting the API" });
  const para1 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para1.appendText("VaultQuery exposes its API through the global ");
  para1.createEl('code', { cls: 'vaultquery-help-code', text: "app" });
  para1.appendText(" object. First, check if VaultQuery is installed and enabled:");
  ctx.renderCode(container, "typescript", "// Get the VaultQuery plugin instance\nconst vaultQuery = this.app.plugins.getPlugin('vaultquery');\n\nif (!vaultQuery) {\n  console.log('VaultQuery plugin is not installed or enabled');\n  return;\n}\n\n// Access the API\nconst api = vaultQuery.api;");
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "TypeScript Types" });
  const para2 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para2.appendText("Add VaultQuery as a dev dependency to import types:");
  ctx.renderCode(container, "bash", "npm install --save-dev github:bobstanton/vaultquery");
  const para3 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para3.appendText("Then import the types you need:");
  ctx.renderCode(container, "typescript", "import type { IVaultQueryAPI, VaultQueryPlugin, QueryResult, PreviewResult } from 'vaultquery';\n\nconst vaultQuery = this.app.plugins.getPlugin('vaultquery') as VaultQueryPlugin | undefined;\nif (!vaultQuery?.api) return;\n\nconst results: QueryResult[] = await vaultQuery.api.query('SELECT * FROM notes');");
  const para4 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para4.appendText("Available types:");
  const table = container.createEl('table', { cls: 'vaultquery-help-table' });
  const thead = table.createEl('thead');
  const row = thead.createEl('tr');
  row.createEl('th', { text: "Type" });
  row.createEl('th', { text: "Description" });
  const tbody = table.createEl('tbody');
  const row1 = tbody.createEl('tr');
  const td = row1.createEl('td');
  td.createEl('code', { cls: 'vaultquery-help-code', text: "VaultQueryPlugin" });
  const td1 = row1.createEl('td');
  td1.appendText("Plugin instance (use with ");
  td1.createEl('code', { cls: 'vaultquery-help-code', text: "getPlugin" });
  td1.appendText(")");
  const row2 = tbody.createEl('tr');
  const td2 = row2.createEl('td');
  td2.createEl('code', { cls: 'vaultquery-help-code', text: "IVaultQueryAPI" });
  row2.createEl('td', { text: "Full API interface" });
  const row3 = tbody.createEl('tr');
  const td3 = row3.createEl('td');
  td3.createEl('code', { cls: 'vaultquery-help-code', text: "QueryResult" });
  row3.createEl('td', { text: "Query result row" });
  const row4 = tbody.createEl('tr');
  const td4 = row4.createEl('td');
  td4.createEl('code', { cls: 'vaultquery-help-code', text: "PreviewResult" });
  row4.createEl('td', { text: "DML preview result" });
  const row5 = tbody.createEl('tr');
  const td5 = row5.createEl('td');
  td5.createEl('code', { cls: 'vaultquery-help-code', text: "NoteSource" });
  const td6 = row5.createEl('td');
  td6.appendText("`");
  td6.appendText("string \\");
  const td7 = row5.createEl('td');
  td7.appendText("TFile");
  td7.appendText("`");
  td7.appendText(" for template variables");
  const row6 = tbody.createEl('tr');
  const td8 = row6.createEl('td');
  td8.createEl('code', { cls: 'vaultquery-help-code', text: "FileIndexedEvent" });
  const td9 = row6.createEl('td');
  td9.appendText("Event data for ");
  td9.createEl('code', { cls: 'vaultquery-help-code', text: "file-indexed" });
  const row7 = tbody.createEl('tr');
  const td10 = row7.createEl('td');
  td10.createEl('code', { cls: 'vaultquery-help-code', text: "FileRemovedEvent" });
  const td11 = row7.createEl('td');
  td11.appendText("Event data for ");
  td11.createEl('code', { cls: 'vaultquery-help-code', text: "file-removed" });
  const row8 = tbody.createEl('tr');
  const td12 = row8.createEl('td');
  td12.createEl('code', { cls: 'vaultquery-help-code', text: "VaultIndexedEvent" });
  const td13 = row8.createEl('td');
  td13.appendText("Event data for ");
  td13.createEl('code', { cls: 'vaultquery-help-code', text: "vault-indexed" });
  const row9 = tbody.createEl('tr');
  const td14 = row9.createEl('td');
  td14.createEl('code', { cls: 'vaultquery-help-code', text: "EventRef" });
  row9.createEl('td', { text: "Event subscription reference" });
  const row10 = tbody.createEl('tr');
  const td15 = row10.createEl('td');
  td15.createEl('code', { cls: 'vaultquery-help-code', text: "IndexingStats" });
  row10.createEl('td', { text: "Performance statistics" });
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "Core API Methods" });
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Executing Queries" });
  ctx.renderCode(container, "typescript", "const results = await api.query('SELECT * FROM notes LIMIT 10');\n\nconst file = this.app.workspace.getActiveFile();\nconst results = await api.query(\n  'SELECT * FROM links WHERE path = {this.path}',\n  file\n);\n\nfor (const row of results) {\n  console.log(row.path, row.title);\n}");
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Waiting for Indexing" });
  const para5 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para5.appendText("At plugin load time, VaultQuery may still be indexing the vault. Use ");
  para5.createEl('code', { cls: 'vaultquery-help-code', text: "waitForIndexing()" });
  para5.appendText(" to ensure complete data:");
  ctx.renderCode(container, "typescript", "async onload() {\n  const vaultQuery = this.app.plugins.getPlugin('vaultquery');\n  if (!vaultQuery) return;\n\n  await vaultQuery.api.waitForIndexing();\n\n  const notes = await vaultQuery.api.query('SELECT COUNT(*) as count FROM notes');\n  console.log(`Indexed ${notes[0].count} notes`);\n}");
  const para6 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para6.createEl('strong', { cls: 'vaultquery-help-bold', text: "Note" });
  para6.appendText(": ");
  para6.createEl('code', { cls: 'vaultquery-help-code', text: "query()" });
  para6.appendText(" does not wait call ");
  para6.createEl('code', { cls: 'vaultquery-help-code', text: "waitForIndexing()" });
  para6.appendText(" internally.");
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Checking Indexing Status" });
  ctx.renderCode(container, "typescript", "const status = api.getIndexingStatus();\n\nif (status.isIndexing) {\n  console.log(`Indexing: ${status.progress.current}/${status.progress.total}`);\n  console.log(`Current file: ${status.progress.currentFile}`);\n} else {\n  console.log('Indexing complete');\n}");
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Triggering Reindexing" });
  ctx.renderCode(container, "typescript", "// Incremental reindex (only modified files)\nawait api.reindexVault();\n\n// Full reindex (clears database and reindexes everything)\nawait api.forceReindexVault();\n\n// Reindex a specific note\nawait api.reindexNote('folder/my-note.md');");
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "Write Operations" });
  const para7 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para7.appendText("VaultQuery supports INSERT, UPDATE, and DELETE operations that sync changes back to markdown files. Write operations require \"Allow write operations\" enabled in VaultQuery settings.");
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Preview and Apply Pattern" });
  ctx.renderCode(container, "typescript", "// Step 1: Preview the changes\nconst preview = await api.previewQuery(`\n  UPDATE tasks\n  SET status = 'DONE', done_date = date('now')\n  WHERE path = 'projects/todo.md' AND task_text LIKE '%review%'\n`);\n\n// Step 2: Inspect the preview\nconsole.log(`Operation: ${preview.operationType}`);\nconsole.log(`Affected rows: ${preview.affectedRowCount}`);\nconsole.log('Before:', preview.beforeRows);\nconsole.log('After:', preview.afterRows);\n\n// Step 3: Apply if satisfied\nif (preview.affectedRowCount > 0) {\n  const affectedPaths = await api.applyPreview(preview);\n  console.log('Modified files:', affectedPaths);\n}");
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Insert Example" });
  ctx.renderCode(container, "typescript", "// Create a new note\nconst preview = await api.previewQuery(`\n  INSERT INTO notes (path, title, content)\n  VALUES ('new-note.md', 'New Note', '# New Note\\n\\nContent here')\n`);\n\nawait api.applyPreview(preview);");
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Update Example" });
  ctx.renderCode(container, "typescript", "// Mark tasks as complete\nconst preview = await api.previewQuery(`\n  UPDATE tasks\n  SET status = 'DONE', done_date = date('now')\n  WHERE status = 'TODO' AND due_date < date('now')\n`);\n\nif (preview.affectedRowCount > 0) {\n  await api.applyPreview(preview);\n}");
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Delete Example" });
  ctx.renderCode(container, "typescript", "// Delete old notes (requires \"Allow file deletion\" setting)\nconst preview = await api.previewQuery(`\n  DELETE FROM notes\n  WHERE path LIKE 'archive/%'\n    AND modified < strftime('%s', 'now', '-1 year') * 1000\n`);\n\nawait api.applyPreview(preview);");
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "Custom SQL Functions" });
  const para8 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para8.appendText("Register custom JavaScript functions for use in SQL queries:");
  ctx.renderCode(container, "typescript", "// Register a simple function\napi.registerCustomFunction('reverse', `\n  function(str) {\n    if (str === null) return null;\n    return String(str).split('').reverse().join('');\n  }\n`);\n\n// Use in queries\nconst results = await api.query(`\n  SELECT title, reverse(title) as reversed\n  FROM notes\n  LIMIT 5\n`);\n\n// Register a function with multiple parameters\napi.registerCustomFunction('concat_with', `\n  function(separator, ...args) {\n    return args.filter(a => a !== null).join(separator || '');\n  }\n`);");
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "Executing DDL Statements" });
  const para9 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para9.appendText("Use ");
  para9.createEl('code', { cls: 'vaultquery-help-code', text: "execute()" });
  para9.appendText(" for statements that don't return query results. It returns the number of rows affected:");
  ctx.renderCode(container, "typescript", "// Create a custom view (returns 0 for DDL)\nconst affected = api.execute(`\n  CREATE VIEW IF NOT EXISTS recent_notes AS\n  SELECT path, title, modified\n  FROM notes\n  WHERE modified > strftime('%s', 'now', '-7 days') * 1000\n  ORDER BY modified DESC\n`);\n\n// Query the view\nconst recent = await api.query('SELECT * FROM recent_notes');");
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "Checking Capabilities" });
  const para10 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para10.appendText("Before using certain features, check what's available based on user settings:");
  ctx.renderCode(container, "typescript", "const caps = api.getCapabilities();\n\n// Check if write operations are enabled\nif (caps.writeEnabled) {\n  const preview = await api.previewQuery('UPDATE tasks SET status = \"DONE\"...');\n  await api.applyPreview(preview);\n} else {\n  new Notice('Write operations are disabled in VaultQuery settings');\n}\n\n// Check if specific data is indexed\nif (caps.indexing.tasks) {\n  const tasks = await api.query('SELECT * FROM tasks WHERE status = \"TODO\"');\n}\n\nif (caps.indexing.headings) {\n  const headings = await api.query('SELECT * FROM headings WHERE level = 1');\n}\n\n// Check if file deletion is allowed\nif (caps.fileDeleteEnabled) {\n  // Can use DELETE FROM notes\n}");
  const para11 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para11.appendText("The capabilities object includes:");
  const table1 = container.createEl('table', { cls: 'vaultquery-help-table' });
  const thead1 = table1.createEl('thead');
  const row11 = thead1.createEl('tr');
  row11.createEl('th', { text: "Property" });
  row11.createEl('th', { text: "Description" });
  const tbody1 = table1.createEl('tbody');
  const row12 = tbody1.createEl('tr');
  const td16 = row12.createEl('td');
  td16.createEl('code', { cls: 'vaultquery-help-code', text: "writeEnabled" });
  row12.createEl('td', { text: "INSERT/UPDATE/DELETE operations are allowed" });
  const row13 = tbody1.createEl('tr');
  const td17 = row13.createEl('td');
  td17.createEl('code', { cls: 'vaultquery-help-code', text: "fileDeleteEnabled" });
  row13.createEl('td', { text: "DELETE FROM notes (file deletion) is allowed" });
  const row14 = tbody1.createEl('tr');
  const td18 = row14.createEl('td');
  td18.createEl('code', { cls: 'vaultquery-help-code', text: "indexing.content" });
  row14.createEl('td', { text: "Note content is indexed" });
  const row15 = tbody1.createEl('tr');
  const td19 = row15.createEl('td');
  td19.createEl('code', { cls: 'vaultquery-help-code', text: "indexing.frontmatter" });
  const td20 = row15.createEl('td');
  td20.createEl('code', { cls: 'vaultquery-help-code', text: "properties" });
  td20.appendText(" table is available");
  const row16 = tbody1.createEl('tr');
  const td21 = row16.createEl('td');
  td21.createEl('code', { cls: 'vaultquery-help-code', text: "indexing.tables" });
  const td22 = row16.createEl('td');
  td22.createEl('code', { cls: 'vaultquery-help-code', text: "table_cells" });
  td22.appendText(" table is available");
  const row17 = tbody1.createEl('tr');
  const td23 = row17.createEl('td');
  td23.createEl('code', { cls: 'vaultquery-help-code', text: "indexing.tasks" });
  const td24 = row17.createEl('td');
  td24.createEl('code', { cls: 'vaultquery-help-code', text: "tasks" });
  td24.appendText(" table is available");
  const row18 = tbody1.createEl('tr');
  const td25 = row18.createEl('td');
  td25.createEl('code', { cls: 'vaultquery-help-code', text: "indexing.headings" });
  const td26 = row18.createEl('td');
  td26.createEl('code', { cls: 'vaultquery-help-code', text: "headings" });
  td26.appendText(" table is available");
  const row19 = tbody1.createEl('tr');
  const td27 = row19.createEl('td');
  td27.createEl('code', { cls: 'vaultquery-help-code', text: "indexing.links" });
  const td28 = row19.createEl('td');
  td28.createEl('code', { cls: 'vaultquery-help-code', text: "links" });
  td28.appendText(" table is available");
  const row20 = tbody1.createEl('tr');
  const td29 = row20.createEl('td');
  td29.createEl('code', { cls: 'vaultquery-help-code', text: "indexing.tags" });
  const td30 = row20.createEl('td');
  td30.createEl('code', { cls: 'vaultquery-help-code', text: "tags" });
  td30.appendText(" table is available");
  const row21 = tbody1.createEl('tr');
  const td31 = row21.createEl('td');
  td31.createEl('code', { cls: 'vaultquery-help-code', text: "indexing.listItems" });
  const td32 = row21.createEl('td');
  td32.createEl('code', { cls: 'vaultquery-help-code', text: "list_items" });
  td32.appendText(" table is available");
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "Schema Information" });
  const para12 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para12.appendText("Get the current database schema as markdown:");
  ctx.renderCode(container, "typescript", "const schemaMarkdown = api.getSchemaInfo();\nconsole.log(schemaMarkdown);\n// Returns formatted markdown with all tables, columns, and types");
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "Utility Methods" });
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Check if a File Should Be Indexed" });
  ctx.renderCode(container, "typescript", "const file = this.app.vault.getAbstractFileByPath('notes/example.md');\nif (file instanceof TFile && api.shouldIndexFile(file)) {\n  console.log('This file will be indexed');\n}");
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Check if a File Needs Reindexing" });
  ctx.renderCode(container, "typescript", "const file = this.app.vault.getAbstractFileByPath('notes/example.md');\nif (file instanceof TFile) {\n  const needsUpdate = await api.needsIndexing(file);\n  if (needsUpdate) {\n    await api.indexNote(file);\n  }\n}");
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Get All Indexed Files" });
  ctx.renderCode(container, "typescript", "const indexedFiles = await api.getIndexedFiles();\nfor (const file of indexedFiles) {\n  console.log(`${file.path} - modified: ${new Date(file.modified)}`);\n}");
  container.createEl('h3', { cls: 'vaultquery-help-heading vaultquery-help-h3', text: "Remove a Note from Index" });
  ctx.renderCode(container, "typescript", "// Remove without deleting the file\napi.removeNote('notes/removed.md');");
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "Template Variables" });
  const para13 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para13.appendText("When passing a ");
  para13.createEl('code', { cls: 'vaultquery-help-code', text: "noteSource" });
  para13.appendText(" (TFile or path string), these template variables are available:");
  const table2 = container.createEl('table', { cls: 'vaultquery-help-table' });
  const thead2 = table2.createEl('thead');
  const row22 = thead2.createEl('tr');
  row22.createEl('th', { text: "Variable" });
  row22.createEl('th', { text: "Description" });
  const tbody2 = table2.createEl('tbody');
  const row23 = tbody2.createEl('tr');
  const td33 = row23.createEl('td');
  td33.createEl('code', { cls: 'vaultquery-help-code', text: "{this.path}" });
  row23.createEl('td', { text: "Full file path" });
  const row24 = tbody2.createEl('tr');
  const td34 = row24.createEl('td');
  td34.createEl('code', { cls: 'vaultquery-help-code', text: "{this.name}" });
  row24.createEl('td', { text: "Filename with extension" });
  const row25 = tbody2.createEl('tr');
  const td35 = row25.createEl('td');
  td35.createEl('code', { cls: 'vaultquery-help-code', text: "{this.basename}" });
  row25.createEl('td', { text: "Filename without extension" });
  const row26 = tbody2.createEl('tr');
  const td36 = row26.createEl('td');
  td36.createEl('code', { cls: 'vaultquery-help-code', text: "{this.extension}" });
  row26.createEl('td', { text: "File extension" });
  const row27 = tbody2.createEl('tr');
  const td37 = row27.createEl('td');
  td37.createEl('code', { cls: 'vaultquery-help-code', text: "{this.folder}" });
  row27.createEl('td', { text: "Parent folder path" });
  const row28 = tbody2.createEl('tr');
  const td38 = row28.createEl('td');
  td38.createEl('code', { cls: 'vaultquery-help-code', text: "{this.created}" });
  row28.createEl('td', { text: "Creation timestamp (ms)" });
  const row29 = tbody2.createEl('tr');
  const td39 = row29.createEl('td');
  td39.createEl('code', { cls: 'vaultquery-help-code', text: "{this.modified}" });
  row29.createEl('td', { text: "Modified timestamp (ms)" });
  const row30 = tbody2.createEl('tr');
  const td40 = row30.createEl('td');
  td40.createEl('code', { cls: 'vaultquery-help-code', text: "{this.size}" });
  row30.createEl('td', { text: "File size in bytes" });
  const row31 = tbody2.createEl('tr');
  const td41 = row31.createEl('td');
  td41.createEl('code', { cls: 'vaultquery-help-code', text: "{this.frontmatter.key}" });
  row31.createEl('td', { text: "Frontmatter property value" });
  const para14 = container.createEl('p', { cls: 'vaultquery-help-paragraph' });
  para14.appendText("Example:");
  ctx.renderCode(container, "typescript", "const file = this.app.workspace.getActiveFile();\n\n// Find notes in the same folder\nconst siblings = await api.query(`\n  SELECT path, title FROM notes\n  WHERE path LIKE '{this.folder}/%'\n    AND path != '{this.path}'\n`, file);\n\n// Find notes linking to current note\nconst backlinks = await api.query(`\n  SELECT path, link_text FROM links\n  WHERE link_target_path = '{this.path}'\n`, file);");
  container.createEl('h2', { cls: 'vaultquery-help-heading vaultquery-help-h2', text: "Error Handling" });
  ctx.renderCode(container, "typescript", "try {\n  const results = await api.query('SELECT * FROM invalid_table');\n} catch (error) {\n  // Error messages include helpful hints\n  // e.g., \"no such table: properties\n  //        Note: Property indexing is disabled. Enable it in Settings...\"\n  console.error(error.message);\n}\n\n// Check if write operations are allowed before previewing\ntry {\n  const preview = await api.previewQuery('UPDATE notes SET title = \"test\"');\n} catch (error) {\n  if (error.message.includes('Write operations are disabled')) {\n    // Prompt user to enable in settings\n  }\n}");
}